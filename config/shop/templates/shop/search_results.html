{% extends 'shop/base.html' %}
{% load static %}

{% block title %}Search Results - CamX.lk{% endblock %}

{% block content %}

<h2>Search Results for "{{ query }}"</h2>

<!-- SEARCH FORM WITH CATEGORY -->
<form method="GET" action="{% url 'search_results' %}" class="search-form">
    <input type="text" name="q" placeholder="Search cameras, lenses, accessories" value="{{ query }}">
    
    <select name="category">
        <option value="">All Categories</option>
        {% for key, name in categories %}
            <option value="{{ key }}" {% if key == category %}selected{% endif %}>{{ name }}</option>
        {% endfor %}
    </select>
    
    <button type="submit">Search</button>
</form>

<!-- RESULTS GRID -->
{% if results %}
    <div class="product-grid">
        {% for product in results %}
        <div class="product-card">
            <a href="{% url 'product_detail' product.id %}">
                <img src="{{ product.image.url }}" alt="{{ product.name }}">
                <h3>{{ product.name }}</h3>
            </a>
            <p>Price: LKR {{ product.price }}</p>
        </div>
        {% endfor %}
    </div>
{% else %}
    <p>No products found for "{{ query }}".</p>
{% endif %}

{% endblock %}

{% block extra_head %}
<style>
/* GRID & CARD STYLES */
body {
    font-family: Arial, sans-serif;
    background-color: #eef0f8ff;
    margin: 20px;
}
.product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}
.product-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    transition: transform 0.2s;
    background-color: #fff;
}
.product-card:hover {
    transform: scale(1.05);
}
.product-card img {
    max-width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 5px;
}
.product-card h3 {
    font-size: 1.1rem;
    margin: 10px 0;
}

/* SEARCH FORM STYLES */
.search-form {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}
.search-form input[type="text"] {
    flex: 2;
    padding: 8px;
    border-radius: 5px;
    border: 1px solid #f4f3f9ff;
}
.search-form select {
    flex: 1;
    padding: 8px;
    border-radius: 5px;
    border: 1px solid #ccc;
}
.search-form button {
    padding: 8px 15px;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
.search-form button:hover {
    background-color: #0056b3;
}
</style>
{% endblock %}